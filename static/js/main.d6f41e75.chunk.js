(this.webpackJsonppoker99=this.webpackJsonppoker99||[]).push([[0],{178:function(r,n,e){},179:function(r,n){function e(r){var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}e.keys=function(){return[]},e.resolve=e,r.exports=e,e.id=179},184:function(r,n){},186:function(r,n){},196:function(r,n){},198:function(r,n){},225:function(r,n){},226:function(r,n){},231:function(r,n){},233:function(r,n){},240:function(r,n){},259:function(r,n){},285:function(r,n,e){"use strict";e.r(n);var t,c,a=e(11),u=e(0),i=e.n(u),o=e(12),s=e.n(o),f=(e(178),e(9)),d=e(14),l=e(47),b=e(165),p=e(164),j=function(r){Object(b.a)(e,r);var n=Object(p.a)(e);function e(){var r;Object(l.a)(this,e);for(var t=arguments.length,c=new Array(t),a=0;a<t;a++)c[a]=arguments[a];return(r=n.call.apply(n,[this].concat(c))).maxPlayer=4,r.minPlayer=4,r.turn=0,r.direction=1,r.points=0,r.dead={},r.drawDeck=[],r.trashDeck=[],r.playerDeck=[],r.logs=[],r}return e}(d.b),h=e(66);!function(r){r[r.PLAY_CARD=0]="PLAY_CARD",r[r.END=1]="END"}(t||(t={})),function(r){r[r.SPADE=0]="SPADE",r[r.HEART=1]="HEART",r[r.CLUB=2]="CLUB",r[r.DIAMOND=3]="DIAMOND"}(c||(c={}));var v={1:1,2:2,3:3,4:0,5:0,6:6,7:7,8:8,9:9,10:10,11:0,12:20,13:99},y=function(r){var n=r.card;return function(r){return function(r){return 13===r.number}(n)?(r.points=99,L(C(r))):r}},O=function(r){return(r.suit!==c.SPADE||1!==r.number)&&[1,2,3,6,7,8,9].includes(r.number)},m=function(r){var n=r.card;return function(r){if(O(n)){var e=r.points+v[n.number];if(e>99)throw new Error("playing this card will exceed 99");return L(C(Object(f.a)(Object(f.a)({},r),{},{points:e})))}return r}},w=function(r){return 10===r.number||12===r.number},D=function(r){var n=r.card,e=r.increase;return function(r){if(w(n)){if(void 0===e)throw new Error("increase is required in payload");var t=r.points+(e?v[n.number]:-v[n.number]);if(t>99)throw new Error("playing this card will exceed 99");return L(C(Object(f.a)(Object(f.a)({},r),{},{points:t})))}return r}},k=function(r){var n=r.card;return function(r){return function(r){return 4===r.number}(n)?(r.direction*=-1,L(C(r))):r}},x=function(r){var n=r.card;return function(r){return function(r){return 11===r.number}(n)?L(C(r)):r}},g=function(r,n){var e=r.card,t=r.target;return function(r){if(function(r){return 5===r.number}(e)){if(void 0===t)throw new Error("target is required in payload");if(t===n)throw new Error("cannot target myself");return r.turn=t,L(r)}return r}},A=function(r){var n=r.card;return function(r){return function(r){return 1===r.number&&r.suit===c.SPADE}(n)?(r.points=1,L(C(r))):r}},E=function r(n){return function(e){if(e.playerDeck[n].length>=5)throw new Error("cannot draw, ".concat(e.players[n]," already has ").concat(5," cards"));var t=e.drawDeck.shift();return void 0===t?r(n)(Object(f.a)(Object(f.a)({},e),{},{drawDeck:Object(d.e)(e.trashDeck),trashDeck:[]})):(e.playerDeck[n].push(t),Object(f.a)({},e))}},P=function(r,n){var e=r.card;return function(r){return r.trashDeck.push(e),r.playerDeck[n]=r.playerDeck[n].filter((function(r){var n=r.suit,t=r.number;return!(n===e.suit&&t===e.number)})),r}},C=function(r){var n=(r.turn+r.maxPlayer+r.direction)%r.maxPlayer;return Object(f.a)(Object(f.a)({},r),{},{turn:n})},L=function r(n){return!n.dead[n.turn]&&function(r,n){var e=1/0,t=0;return n.forEach((function(n,a){var u,i=n.suit,o=n.number;(u=i===c.SPADE&&1===o?1:10===o?r-10:12===o?r-20:13===o?99:r+v[o])<e&&(e=u,t=a)})),[e,t]}(n.points,n.playerDeck[n.turn])[0]>99&&(n.logs.push("".concat(n.players[n.turn]," die, his card: ").concat(n.playerDeck[n.turn].map((function(r){return"".concat(c[r.suit]).concat(r.number)})).join(","))),n.dead[n.turn]=!0),Object.keys(n.dead).length===n.players.length-1&&n.started&&(n.winner=[0,1,2,3].filter((function(r){return!n.dead[r]}))[0]),n.dead[n.turn]?r(C(Object(f.a)(Object(f.a)({},n),{},{turn:n.turn}))):Object(f.a)(Object(f.a)({},n),{},{turn:n.turn})},N=function(r,n){var e=n.peerId;if(void 0===e)throw new Error("Expect peerId in action");switch(n.type){case d.a.START:return function(r){(r=Object(f.a)(Object(f.a)({},r),{},{drawDeck:[],trashDeck:[],playerDeck:[],points:0,direction:1,turn:0,dead:{},logs:["game started"],winner:null})).drawDeck=Object(d.e)(function(){for(var r=[],n=0;n<4;n++)for(var e=1;e<=13;e++)r.push({suit:n,number:e});return r}());for(var n=0;n<r.players.length;n++){r.playerDeck[n]=[];for(var e=0;e<5;e++)r=E(n)(r)}return Object(f.a)({},r)}(r);case t.PLAY_CARD:return function(r,n){return function(e){var t=n.card,a="".concat(c[t.suit]).concat(t.number);if(void 0===e.playerDeck[r].find((function(r){var n=r.suit,e=r.number;return n===t.suit&&e===t.number})))throw new Error("".concat(e.players[r]," doesnt own card ").concat(a));if(e.turn!==r)throw new Error("not your turn");return d.d.apply(void 0,[E(r)].concat(Object(h.a)([P,y,m,D,k,x,g,A].map((function(e){return e(n,r)})))))(e)}}(function(){var n=r.nameDict[r.members[e]];if(void 0===n)throw new Error("game not started");return n}(),n.payload)(JSON.parse(JSON.stringify(r)));case t.END:return Object(f.a)(Object(f.a)({},r),{},{started:!1})}return r},S=e(52),R=function(r){return[4,5,11,13].includes(r.number)},_=function(r,n){var e=r.playerDeck[n],c=r.points,a=e.filter(O).sort((function(r,n){return v[n.number]-v[r.number]})),u=e.find((function(r){return 13===r.number}));if(void 0!==u&&99!==c&&a.length<3)return{type:t.PLAY_CARD,payload:{card:u}};var i,o=Object(S.a)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(c+v[s.number]<=99)return{type:t.PLAY_CARD,payload:{card:s}}}}catch(g){o.e(g)}finally{o.f()}var f,l=e.filter(w),b=Object(S.a)(l.sort((function(r,n){return n.number-r.number})));try{for(b.s();!(f=b.n()).done;){var p=f.value;if(c+v[p.number]<=99)return{type:t.PLAY_CARD,payload:{card:p,increase:!0}}}}catch(g){b.e(g)}finally{b.f()}var j=e.find(R);if(void 0!==j)return{type:t.PLAY_CARD,payload:{card:j,target:r.nameDict[Object(d.e)(r.players.filter((function(e,t){return!r.dead[t]&&t!==n})))[0]]}};var h,y=Object(S.a)(l.sort((function(r,n){return r.number-n.number})));try{for(y.s();!(h=y.n()).done;){var m=h.value;if(c-v[m.number]<=99)return{type:t.PLAY_CARD,payload:{card:m,increase:!1}}}}catch(g){y.e(g)}finally{y.f()}var D,k=Object(S.a)(e);try{for(k.s();!(D=k.n()).done;){var x=D.value;if(c-v[x.number]<=99)return{type:t.PLAY_CARD,payload:{card:x,increase:!1}}}}catch(g){k.e(g)}finally{k.f()}throw new Error("reached an edge case")},Y=Object(u.createContext)(null),I=function(){var r=Object(u.useContext)(Y);if(null===r)throw new Error("please wrap it using withPoker99Network before calling this hook");return r},T=e(68),F=e(53),B=e.n(F),J=e(96),M=e(97),U=function(){var r=I(),n=r.state,e=r.dispatch,i=r.dispatchAs,o=r.myPlayerId,s=r.myLocals,f=r.hideDeck,d=r.setHideDeck,l=r.error,b=r.setError,p=r.renderedDeckId,j=Object(u.useState)(0),h=Object(M.a)(j,2),v=h[0],y=h[1],O=Object(u.useState)(!0),m=Object(M.a)(O,2),w=m[0],D=m[1],k=1===n.direction?">":"<",x=function(r){b(r.message)},g=function(r){return Object(J.a)(B.a.mark((function c(){var a;return B.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(a={type:t.PLAY_CARD,payload:{card:r,increase:w,target:v}},n.turn!==o){c.next=6;break}return c.next=4,e(a).then((function(){return b("")})).catch(x);case 4:c.next=12;break;case 6:if(!s.includes(n.players[n.turn])){c.next=11;break}return c.next=9,i(n.turn,a).then((function(){return b("")})).catch(x);case 9:c.next=12;break;case 11:b("Not my turn");case 12:case"end":return c.stop()}}),c)})))},A=function(r){var e;return null===(e=n.playerDeck[r])||void 0===e?void 0:e.map((function(r){return Object(a.jsxs)("button",{onClick:g(r),children:[c[r.suit]," ",r.number]},10*r.number+r.suit)}))},E=function(){var r=Object(J.a)(B.a.mark((function r(){return B.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e({type:t.END}).catch(x);case 2:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return Object(a.jsxs)("div",{style:{pointerEvents:"all"},children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("h3",{children:n.points}),Object(a.jsxs)("h6",{children:[n.players[n.turn],"'","s turn"]}),""!==l&&Object(a.jsx)("div",{style:{color:"red"},children:l}),void 0!==n.winner&&null!==n.winner&&Object(a.jsxs)("div",{children:["winner is ",n.players[n.winner],Object(a.jsx)("button",{onClick:E,children:"again"})]}),n.players.map((function(r,e){return Object(a.jsxs)("span",{onClick:function(){return y(e)},style:{fontWeight:n.turn===e?"bold":"normal",textDecorationLine:n.dead[e]?"line-through":"none"},children:[r," ",k]},r)})),Object(a.jsx)("div",{children:0===s.length?A(o):f?Object(a.jsxs)("button",{onClick:function(){return d(!1)},children:["show ",n.players[p]]}):A(p)}),Object(a.jsxs)("div",{children:["target: ",v]}),Object(a.jsx)("button",{onClick:function(){return D(!w)},children:w?"+":"-"})]}),Object(a.jsx)("div",{children:n.logs.slice().reverse().map((function(r,n){return Object(a.jsx)("div",{children:r},n)}))})]})},H=function(r){var n=function(n){var e=Object(d.f)(N,new j,_);return Object(a.jsx)(Y.Provider,{value:e,children:Object(a.jsx)(r,Object(f.a)({},n))})};return n.displayName="WithGameNetwork",n}((function(){var r=I();return Object(a.jsxs)(T.a,{gameAppState:r.gameAppState,fullPage:[!1,!1,!0],children:[Object(a.jsx)(T.b,Object(f.a)(Object(f.a)({},r),{},{gameName:"Poker100"})),Object(a.jsx)(T.c,Object(f.a)({},r)),Object(a.jsx)(U,{})]})})),q=function(r){r&&r instanceof Function&&e.e(3).then(e.bind(null,325)).then((function(n){var e=n.getCLS,t=n.getFID,c=n.getFCP,a=n.getLCP,u=n.getTTFB;e(r),t(r),c(r),a(r),u(r)}))};s.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(H,{})}),document.getElementById("root")),q()}},[[285,1,2]]]);
//# sourceMappingURL=main.d6f41e75.chunk.js.map